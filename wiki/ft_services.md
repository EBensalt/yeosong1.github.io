# ft_services 수정중

요약: 이것은 시스템 관리 및 네트워킹 프로젝트 입니다.

## 🌋 ㅇㅏ 일단 도커 업데이트 절대 하지 마세요.... 그냥 쓰세요..

저 지금 **카탈리나** 쓰고있는데 **도커 최신**으로 업데이트 했다가 아래와 같은 문제 발생했고, (그냥 실행 자체가 안됨)

https://github.com/docker/for-mac/issues/5037

https://docs.docker.com/docker-for-mac/release-notes/#docker-community-edition-17120-ce-mac49-2018-01-19

들어가서 **Docker 19.03.12 (2020-07-27) 버전으로 다운그레이드**하고 이제 동작하네요..



## 소개
- Ft_services는 Kubernetes를 소개합니다.
- 클러스터 관리 및 Kubernetes를 사용한 배포를 알게됩니다.
- 당신은 네트워크를 가상화하고 "클러스터링"을 수행할 것입니다.

## General Instruction
- 서버 구성에 필요한 모든 파일을 srcs 폴더에 넣어야합니다. 
- setup.sh 파일은 저장소의 루트에 있어야합니다. 이 스크립트는 모든 응용 프로그램을 셋업합니다.
- 이 서브젝트는 기존의 / 새로운 practices 둘 다 요구 합니다.
- 따라서 많은 양의 문서를 읽는 것을 두려워하지 않는 편이 좋습니다.
- (문서: Docker, Kubernetes, 그외 기타 프로젝트에 유용한 모든 문서들)



**서브젝트 버전: 2020/11/19 다운로드*

## 필수 파트

이 프로젝트는 다양한 서비스의 인프라를 설정하는 것으로 구성됩니다. 이걸 하려면
- 당신은 `Kubernetes`를 사용해야합니다.
- 다중 서비스 클러스터를 설정해야합니다.
- **각 서비스는 전용 컨테이너에서 실행되어야합니다.**
- 각 컨테이너는 관련 서비스와 성능을 위해 반드시 **동일한 이름**을 가져야합니다. Alpine Linux를 사용하여 컨테이너를 빌드해야하기 때문입니다.
- 또한 setup.sh에서 호출되는 **Dockerfile**이 작성되어 있어야합니다.
- 사용할 이미지를 직접 구축해야합니다. 복용하는 것은 금지되어 있습니다.
- 이미 이미지를 빌드하거나 DockerHub와 같은 서비스를 사용합니다.

또한 다음을 설정해야합니다.
- Kubernetes 웹 대시 보드. 이것이 클러스터 관리를 도와줄 것 입니다.
- 서비스의 외부 액세스를 관리하는 `로드 밸런서`. 그것은 클러스터의 유일한 엔트리포인트입니다
다음과 관련된 포트를 유지해야합니다.
- 서비스 (Grafana 등의 경우 IP : 3000). Load Balancer는 단일 IP를 갖습니다.
  -  MySQL 데이터베이스에서 작동하는 포트 5050에서 수신하는 WordPress 웹 사이트.
- 두 서비스 모두 별도의 컨테이너에서 실행되어야합니다.
- WordPress 웹 사이트에는 여러 사용자와 관리자. Wordpress에는 자체 nginx 서버가 필요합니다.
- 그만큼 Load Balancer는이 서비스로 직접 리디렉션 할 수 있어야합니다.
- phpMyAdmin, 포트 5000에서 수신 대기하고 MySQL 데이터베이스와 연결됩니다.
- PhpMyAdmin에는 자체 nginx 서버가 필요합니다.
- 로드 밸런서는 리디렉션 할 수 있어야합니다. 이 서비스에 직접.
- annginx 서버가 포트 80 및 443에서 수신 대기하는 컨테이너.
- 포트 80은 http이며 유형 301에서 443으로의 체계적인 리디렉션이어야합니다. https. 
- 표시되는 페이지는 http 오류가 아닌 한 중요하지 않습니다.
- 이 컨테이너는 리디렉션을 만드는 / wordpress 경로에 대한 액세스를 허용합니다. 307 IP : WPPORT로. 또한 IP : PMAPORT에 대한 역방향 프록시를 사용하여 / phpmyadmin에 대한 액세스를 허용해야합니다.
- 포트 21에서 수신 대기하는 FTPS 서버.
- InfluxDB 데이터베이스와 연결된 포트 3000에서 수신 대기하는 Grafana 플랫폼.
- Grafana는 모든 컨테이너를 모니터링합니다. 대시 보드를 하나 만들어야합니다. 서비스 당. InﬂuxDB와 grafana는 두 개의 별개 컨테이너에 있습니다.
- 두 데이터베이스 컨테이너 중 하나가 충돌 또는 중지 된 경우 다음을 수행해야합니다. 데이터가 지속되는지 확인하십시오.
- SSH에 로그인하여 nginx 컨테이너에 액세스 할 수 있어야합니다.
- 모든 컨테이너는 구성 요소 중 하나가 충돌하거나 중지되는 경우 다시 시작해야합니다. 부속.
- 서비스에 대한 각 리디렉션이 로드 밸런서를 사용하여 수행되는지 확인하십시오. FTPS, Grafana, Wordpress, PhpMyAdmin 및 nginx의 종류는 "LoadBalancer"여야합니다.
- Inﬂuxdb MySQL의 종류는 "ClusterIP"여야합니다. 다른 항목이 있을 수 있지만 해당 항목은 없습니다. "NodePort"종류 일 수 있습니다.

다음은 설정해야하는 항목의 예입니다.

<img width="708" alt="스크린샷 2020-11-20 오후 1 05 25" src="https://user-images.githubusercontent.com/53321189/99756721-1a537100-2b31-11eb-94a1-0cec379337bd.png">



### ❗주의

~~~
Node Port 서비스, Ingress Controller 객체 또는 kubectl 사용
포트 포워드 명령은 금지됩니다.
Load Balancer는 클러스터의 유일한 엔트리포인트여야합니다.
~~~

### 💡참고

~~~
클라우드 제공 업체에서 제공하는 로드밸런서를 사용하는 것은 쓸모가 없습니다.
MetalLB를 봐야합니다.
~~~


## 쿠버네티스 배경 쌓기
[44bits의 초보를 위한 쿠버네티스 안내서 유튜브](쿠버네티스_44초보.md)
