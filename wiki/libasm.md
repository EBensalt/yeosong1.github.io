# libasm


- ì„œë¸Œì íŠ¸ [libasm.en-kr.subject.pdf](https://github.com/yeosong1/yeosong1.github.io/files/5485720/en.subject.2.pdf)

## ğŸ¤“ ì¼ë°˜ ì§€ì¹¨ì— ë”°ë¥¸ ë°°ê²½ì§€ì‹ ì •ë¦¬

- [x] 64bit ASM ì„ ì¨ì•¼í•©ë‹ˆë‹¤. (í˜¸ì¶œ ê·œì•½ calling convention ì£¼ì˜)
  - [í˜¸ì¶œ ê·œì•½](https://ko.wikipedia.org/wiki/%ED%98%B8%EC%B6%9C_%EA%B7%9C%EC%95%BD)? ì½”ë“œê°€ í˜¸ì¶œì(caller)ë¡œë¶€í„° ë³€ìˆ˜ë¥¼ ë°›ê³ , ì–´ë–»ê²Œ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ”ì§€ì— ëŒ€í•œ ê·œì•½. 
  - ë¦¬ëˆ…ìŠ¤ëŠ” 64ë¹„íŠ¸ ëª¨ë“œì—ì„œ ì •ìˆ˜ íƒ€ì…ì˜ íŒŒë¼ë¯¸í„° ì „ë‹¬ì‹œ, ìˆœì„œëŒ€ë¡œ RDI, RSI, RDX, RCX, R8, R9ê¹Œì§€ 6ê°œì˜ ë ˆì§€ìŠ¤í„°ë¥¼ ì‚¬ìš©í•˜ê³  7ê°œ ì´ìƒì´ë©´ ìŠ¤íƒì„ í†µí•´ ì „ë‹¬í•©ë‹ˆë‹¤.
    - 32ë¹„íŠ¸ì—ì„œëŠ” ë ˆì§€ìŠ¤í„° ì´ë¦„ë“¤ì´ Eë¡œ ì‹œì‘í•œë‹¤. EDI, ESI, EDX ... 16bit, 8bit.. ë“± ë¹„íŠ¸ë³„ë¡œ ë‹¤ë¥´ë‹¤.
  - ì‹¤ìˆ˜ íƒ€ì…ì˜ íŒŒë¼ë¯¸í„°ì˜ ê²½ìš°ëŠ” XMM0 ~ XMM7ê¹Œì§€ 8ê°œë¥¼ ìˆœì„œëŒ€ë¡œ ì‚¬ìš©í•˜ê³  ê·¸ ì´ìƒì´ë©´ ìŠ¤íƒìœ¼ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.
  - [64ë¹„íŠ¸ ë¦¬ëˆ…ìŠ¤ vs 64ë¹„íŠ¸ ìœˆë„ìš° í˜¸ì¶œ ê·œì•½ ë¹„êµ(Calling Convention)](https://kkamagui.tistory.com/811)

- [x] .s (O) / inline ASM(X)
  - *.s ëŠ” ì–´ì…ˆë¸”ë¦¬ ì½”ë“œì˜ í™•ì¥ìì´ë‹¤. [ì¶œì²˜: ë¸”ë¡œê·¸ Cì–¸ì–´ ê°•ì¢Œ 1í¸](https://blog.hexabrain.net/2)
  - inline ì–´ì…ˆë¸”ë¦¬ëŠ” C ì†ŒìŠ¤ ì½”ë“œì˜ ì¤‘ê°„ì— ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ì–´ë¥¼ ì¶”ê°€í•˜ëŠ” ê´€í–‰ì´ë‹¤. - [ì¶œì²˜: SO documentation](https://sodocumentation.net/ko/c/topic/4263/%EC%9D%B8%EB%9D%BC%EC%9D%B8-%EC%96%B4%EC%85%88%EB%B8%94%EB%A6%AC)
- [x] nasmìœ¼ë¡œ ì»´íŒŒì¼í•´ì•¼ í•©ë‹ˆë‹¤.
  - brew ì„¤ì¹˜(í´ëŸ¬ìŠ¤í„° ë§¥ì—): `curl -fsSL https://rawgit.com/kube/42homebrew/master/install.sh | zsh`
  - nasm ì„¤ì¹˜: `brew install nasm`
  - í„°ë¯¸ë„ì— `nasm -h` í•´ì„œ ì‚¬ìš©ë²•ì„ í™•ì¸í•˜ì: ìš°ë¦¬ì˜ í™˜ê²½ì— ë”°ë¥´ë©´ `nasm -f macho64 *.s`
- [x] ë¬¸ë²•: Intel(O) / AT&T(X)
  - ì–´ì…ˆë¸”ë¦¬ ì»´íŒŒì¼ëŸ¬ = `ì–´ì…ˆë¸”ëŸ¬`
    - `ì»´íŒŒì¼ëŸ¬`: ì†ŒìŠ¤ë¥¼ íŠ¹ì • ì»´í“¨í„° ì•„í‚¤í…ì³ì— ë§ëŠ” ê¸°ê³„ì–´ ì½”ë“œë¡œ ë°”ê¾¸ì–´ ì£¼ëŠ” í”„ë¡œê·¸ë¨
  - ì–´ì…ˆë¸”ëŸ¬ ì¢…ë¥˜ì— ë”°ë¼ ì±„íƒ ê°€ëŠ¥í•œ ë¬¸ë²•ì´ ë‹¤ë¥´ë‹¤.
    - GAS(GNU Assembler) - AT&T ë¬¸ë²•
    - NASM(Netwide Assembler) - Intel ë¬¸ë²•
    - MASM(Microsoft Macro Assembler) - Intel ë¬¸ë²• ë“±.. ì´ì™¸ì—ë„ ì–´ì…ˆë¸”ëŸ¬ëŠ” ì—¬ëŸ¬ê°€ì§€ ì¢…ë¥˜ê°€ ìˆë‹¤.

- [x] í‰ê°€ í•­ëª©ì€ ì•„ë‹ˆì§€ë§Œ, ë™ë£Œí‰ê°€ì‹œ í…ŒìŠ¤íŠ¸ë¥¼ í¸í•˜ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” í…ŒìŠ¤íŠ¸ í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ê¸°ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.
- [x] í• ë‹¹ëœ ê¹ƒ ë ˆí¬ì— ê³¼ì œ ì œì¶œ í•˜ì„¸ìš”. Deepthoughtì˜ ì±„ì  ì¤‘ ì‘ì—… ì„¹ì…˜ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ í‰ê°€ê°€ ì¤‘ì§€ë©ë‹ˆë‹¤.

### ì–´ì…ˆë¸”ë¦¬ ê¸°ì´ˆ ëª…ë ¹ ì •ë¦¬

ì¶œì²˜: [Paul A. Carterì˜ [PC ì–´ì…ˆë¸”ë¦¬ì–´]ì—ì„œ 1.3.4](https://pacman128.github.io/static/pcasm-book-korean.pdf)

| ëª…ë ¹ì–´ | ìˆ˜í–‰ ë‚´ìš© |
| --- | --- |
| mov | `dest, src` |
| add | |
| sub | |
| inc | |
| dec | |

### 

1.4.1

>   ì½”ë“œ ì„¸ê·¸ë¨¼íŠ¸ëŠ” ì—­ì‚¬ì ìœ¼ë¡œ .text ë¼ ë¶ˆë ¤ì™”ë‹¤. ì´ëŠ” ëª…ë ¹ì–´ë“¤ì´ ì €ì¥ë˜ëŠ” ê³³ì´ë‹¤.
> ( 38 í–‰) ì˜ ë©”ì¸ ë£¨í‹´ì˜ ë¼ë²¨ì— ì ‘ë‘ì–´ _ (under score)ê°€ ì‚¬ìš©ë˜ì—ˆìŒì„ ìœ ì˜í•˜ì. ì´ëŠ”
> C í•¨ìˆ˜ í˜¸ì¶œ ê·œì•½ (C calling convention) ì˜ ì¼ë¶€ë¶„ì´ë‹¤. ì´ ê·œì•½ì€ ì½”ë“œ ì»´íŒŒì¼ ì‹œì— C ê°€
> ì‚¬ìš©í•˜ëŠ” ê·œì¹™ë“¤ì„ ëª…ì‹œí•´ ì¤€ë‹¤. ì´ëŠ” ì–´ì…ˆë¸”ë¦¬ì–´ì™€ C ë¥¼ ê°™ì´ ì‚¬ìš©ì‹œì— ì´ í˜¸ì¶œ ê·œì•½
> ì„ ì•„ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤. ë‚˜ì¤‘ì— ì´ í˜¸ì¶œ ê·œì•½ì— ëŒ€í•´ ì†ì† ì‚´í´ ë³¼ ê²ƒì´ë‹¤. ê·¸ëŸ¬ë‚˜,
> ì§€ê¸ˆì€ ì˜¤ì§ ëª¨ë“  C ì‹¬ë³¼ë“¤ (i.e., í•¨ìˆ˜ì™€ ì „ì—­ ë³€ìˆ˜) ì—ëŠ” C ì»´íŒŒì¼ëŸ¬ì— ì˜í•´ _ ê°€ ë§¨ ì•ì—
> ë¶™ëŠ”ë‹¤ëŠ” ì‚¬ì‹¤ë§Œ ì•Œë©´ ëœë‹¤. (ì´ ê·œì¹™ì€ ì˜¤ì§ DOS/Windows ì—ë§Œ í•´ë‹¹í•˜ë©° ë¦¬ëˆ…ìŠ¤ C
> ì»´íŒŒì¼ëŸ¬ì—ì„œëŠ” C ì‹¬ë³¼ ì´ë¦„ì— ì•„ë¬´ê²ƒë„ ë¶™ì´ì§€ ì•ŠëŠ”ë‹¤)
>   37 í–‰ì˜ global ì§€ì‹œì–´ëŠ” ì–´ì…ˆë¸”ëŸ¬ë¡œ í•˜ì—¬ê¸ˆ _asm_main ë¼ë²¨ì„ ì „ì—­ìœ¼ë¡œ ìƒì„±í•˜
> ë¼ê³  ì•Œë ¤ì¤€ë‹¤. C ì—ì„œì™€ëŠ” ë‹¬ë¦¬ ë¼ë²¨ë“¤ì€ ë‚´ë¶€ ì§€ì—­ (internal scope)ì´ ê¸°ë³¸ìœ¼ë¡œ ëœë‹¤.
> ì´ ëœ»ì€ ì˜¤ì§ ê°™ì€ ëª¨ë“ˆì—ì„œë§Œ ê·¸ ë¼ë²¨ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì´ë‹¤. í•˜ì§€ë§Œ ì „ì—­ (global)
> ì§€ì‹œì–´ë¥¼ ì´ìš©í•˜ë©´ ë¼ë²¨ì„ ì™¸ë¶€ ì§€ì—­ (external scope) ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤. ì´ëŸ¬
> í•œ í˜•ì‹ì˜ ë¼ë²¨ì€ í”„ë¡œê·¸ë¨ì˜ ì–´ë– í•œ ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œë„ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤. asm_io ëª¨ë“ˆ
> ì€ print_int ë“±ì„ ëª¨ë‘ ì „ì—­ìœ¼ë¡œ ì„ ì–¸í•œë‹¤. ì´ ë•Œë¬¸ì— ìš°ë¦¬ê°€ first.asm ëª¨ë“ˆì—ì„œ
> ì´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì—ˆë‹¤.







## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

### Makefile ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] $(NAME) (= libasm.a)
- [x] all
- [x] clean
- [x] fclean
- [x] ë¶ˆí•„ìš”í•œ ë¦¬ì»´íŒŒì¼, ë¦¬ë§í¬ ì—†ì–´ì•¼ í•¨.

### í•„ìˆ˜ ì‘ì„± ë° ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ft_strlen
- [ ] ft_strcpy
- [ ] ft_strcmp
- [ ] ft_write
- [ ] ft_read
- [ ] ft_strdup

- [ ] ì‹œìŠ¤í…œì½œsyscall í•˜ëŠ” ì¤‘ì— ì—ëŸ¬ ìˆëŠ”ì§€ ì²´í¬
- [ ] ë³€ìˆ˜ errno ì„¸íŒ… (extern ___error ì‚¬ìš© ê°€ëŠ¥)

### ìµœì¢… ì ê²€

- [ ] segmentation fault
- [ ] bus error
- [ ] double free
- [ ] ê°€ë…ì„±

### ë³´ë„ˆìŠ¤ ì‘ì„±

- [ ] ft_atoi_base
- [ ] ft_list_push_front
- [ ] ft_list_size
- [ ] ft_list_sort
- [ ] ft_list_remove_if

### ë³´ë„ˆìŠ¤ ìµœì¢… ì ê²€

- [ ] rule bonus
- [ ] _bonus.c / _bonus.h
- [ ] segmentation fault
- [ ] bus error
- [ ] double free
- [ ] ê°€ë…ì„±



